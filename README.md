javascript:eval(atob('CgoJIWZ1bmN0aW9uIGphamEoZSkgewoJICBsZXQgJHNjb3BlID0gZSA9ICQuZXh0ZW5kKHsKCSAgICBiYWNrIDogNDksCgkgICAgZW5hYmxlRGlzYWJsZSA6IDkyLAoJICAgIGxpc3RzIDogewoJICAgICAgdXAgOiAzOCwKCSAgICAgIGRvd24gOiA0MCwKCSAgICAgIHByZXYgOiAzNywKCSAgICAgIG5leHQgOiAzOQoJICAgIH0sCgkgICAgc2VhcmNoIDogewoJICAgICAgZGVjTWluQmlkIDogMzcsCgkgICAgICBpbmNNaW5CaWQgOiAzOSwKCSAgICAgIGRlY01heEJpZCA6IDM1LAoJICAgICAgaW5jTWF4QmlkIDogMzYsCgkgICAgICBkZWNNaW5CdXkgOiA0NiwKCSAgICAgIGluY01pbkJ1eSA6IDM0LAoJICAgICAgZGVjTWF4QnV5IDogNDAsCgkgICAgICBpbmNNYXhCdXkgOiAzOCwKCSAgICAgIHNlYXJjaCA6IDUwCgkgICAgfSwKCSAgICByZXN1bHRzIDogewoJICAgICAgYmlkIDogNTIsCgkgICAgICBidXkgOiA1MSwKCSAgICAgIHRyYW5zZmVyIDogODIsCgkgICAgICBjbHViIDogNjcsCgkgICAgICBwcmVzc0VudGVyIDogdHJ1ZSwKCSAgICAgIGF1dG9CdXkgOiBmYWxzZSwKCSAgICAgIHByZXZlbnRCYWNrIDogZmFsc2UsCgkgICAgICBzZWxsIDogODEsCgkgICAgICBkZWNCaWQgOiA0NiwKCSAgICAgIGluY0JpZCA6IDM0CgkgICAgfQoJICB9LCBlIHx8IHt9KTsKCSAgdmFyICRidXR0b24gPSAkKCcudXQtdGFiLWJhcicpLmNsb25lKCk7CgkgICRidXR0b24uZW1wdHkoKQoJICAkYnV0dG9uLmFwcGVuZCgiPGJ1dHRvbiBjbGFzcz0ndXQtdGFiLWJhci1pdGVtJyBpZD0nYmFja1NuJyBzdHlsZT0nIGN1cnNvcjogcG9pbnRlcjsnPjxzcGFuPkF0cmFzPC9zcGFuPjwvYnV0dG9uPiIpOwoJICAkYnV0dG9uLmFwcGVuZCgiPGJ1dHRvbiBjbGFzcz0ndXQtdGFiLWJhci1pdGVtJyBpZD0nc2VhcmNoU24nIHN0eWxlPSdiYWNrZ3JvdW5kOiBvcmFuZ2U7IGN1cnNvcjogcG9pbnRlcjsnPjxzcGFuPkJ1c2Nhcjwvc3Bhbj48L2J1dHRvbj4iKTsKCSAgJGJ1dHRvbi5hcHBlbmQoIjxidXR0b24gY2xhc3M9J3V0LXRhYi1iYXItaXRlbScgaWQ9J2J1eU5vd1NuJyBzdHlsZT0nIGN1cnNvcjogcG9pbnRlcjsnPjxzcGFuPkNvbXByYSB5YTwvc3Bhbj48L2J1dHRvbj4iKTsKCSAgJCgnLnV0LW5hdmlnYXRpb24tY29udGFpbmVyLXZpZXcnKS5hZnRlcigkYnV0dG9uKTsKCSAgbGV0IGV2ZW50ID0gdHJ1ZTsKCSAgbGV0IGxhc3RGZXRjaFRpbWUgPSBuZXcgRGF0ZTsKCSAgbGV0IHMgPSBmYWxzZTsKCSAgLyoqIEB0eXBlIHtudW1iZXJ9ICovCgkgIHdpbmRvdy5NQVhfTkVXX0lURU1TID0gTnVtYmVyLk1BWF9WQUxVRTsKCSAgY29uc3QgSGFuID0gd2luZG93LnNlcnZpY2VzLkxvY2FsaXphdGlvbjsKCSAgY29uc3QgZGlzcGF0Y2hFdmVudCA9IChlbGVtLCB0eXBlKSA9PiB7CgkgICAgaWYgKDAgPT0gZWxlbS5sZW5ndGgpIHsKCSAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9CgkgICAgY29uc3QgcmVwbGF5RXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgiTW91c2VFdmVudHMiKTsKCSAgICByZXR1cm4gcmVwbGF5RXZlbnQuaW5pdEV2ZW50KHR5cGUpLCBlbGVtWzBdLmRpc3BhdGNoRXZlbnQocmVwbGF5RXZlbnQpLCB0cnVlOwoJICB9OwoJICBjb25zdCBvayA9IChleHRyYSkgPT4gewoJICAgIHJldHVybiAoKGV2ZW50KSA9PiB7CgkgICAgICByZXR1cm4gZGlzcGF0Y2hFdmVudChldmVudCwgIm1vdXNlZG93biIpOwoJICAgIH0pKGV4dHJhKSAmJiAoKGV2ZW50KSA9PiB7CgkgICAgICByZXR1cm4gZGlzcGF0Y2hFdmVudChldmVudCwgIm1vdXNldXAiKTsKCSAgICB9KShleHRyYSk7CgkgIH07CgkgIGNvbnN0IHRyeVBhcnNlUVJDb2RlID0gKCkgPT4gewoJICAgIGxldCBpbnRlcnZhbEZ1bmN0aW9uQ2FsbGVkID0gJCgiLmRpYWxvZy1ib2R5IC51dC1idXR0b24tZ3JvdXAgYnV0dG9uOmVxKDApIik7CgkgICAgaWYgKG9rKGludGVydmFsRnVuY3Rpb25DYWxsZWQpKSB7CgkgICAgICAvKiogQHR5cGUge2Jvb2xlYW59ICovCgkgICAgICBzID0gZmFsc2U7CgkgICAgfSBlbHNlIHsKCSAgICAgIHNldFRpbWVvdXQodHJ5UGFyc2VRUkNvZGUsIDEwKTsKCSAgICB9CgkgIH07CgkgIGNvbnN0IGlubmVyVGltZXIgPSAoKSA9PiB7CgkgICAgaWYgKCEobmV3IERhdGUgLSBsYXN0RmV0Y2hUaW1lIDwgNTAwKSkgewoJICAgICAgLyoqIEB0eXBlIHshRGF0ZX0gKi8KCSAgICAgIGxhc3RGZXRjaFRpbWUgPSBuZXcgRGF0ZTsKCSAgICAgIGlmICghb2soJCgiLnV0LW5hdmlnYXRpb24tYnV0dG9uLWNvbnRyb2wiKSkpIHsKCSAgICAgICAgc2V0VGltZW91dChpbm5lclRpbWVyLCAxMCk7CgkgICAgICB9CgkgICAgfQoJICB9OwoJICBjb25zdCBpbml0ID0gKCkgPT4gewoJICAJY29uc29sZS5sb2coJ2FjYSB0YW1iaWVuJykKCSAgICBsZXQgb2JqID0ge307CgkgICAgaWYgKCQoIi5TZWFyY2hSZXN1bHRzIikubGVuZ3RoID4gMCAmJiAob2JqWyRzY29wZS5iYWNrXSA9ICgpID0+IHsKCSAgICAgIHJldHVybiBpbm5lclRpbWVyKCk7CgkgICAgfSksICQoIi51dC1tYXJrZXQtc2VhcmNoLWZpbHRlcnMtdmlldyIpLmxlbmd0aCA+IDApIHsKCSAgICAgIC8qKgoJICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICovCgkgICAgICBvYmpbJHNjb3BlLnNlYXJjaC5kZWNNaW5CaWRdID0gKCkgPT4gewoJICAgICAgICByZXR1cm4gb2soJCgiLmRlY3JlbWVudC12YWx1ZSIpKTsKCSAgICAgIH07CgkgICAgICAvKioKCSAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAqLwoJICAgICAgb2JqWyRzY29wZS5zZWFyY2guaW5jTWluQmlkXSA9ICgpID0+IHsKCSAgICAgICAgcmV0dXJuIG9rKCQoIi5pbmNyZW1lbnQtdmFsdWUiKSk7CgkgICAgICB9OwoJICAgICAgLyoqCgkgICAgICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CgkgICAgICAgKi8KCSAgICAgIG9ialskc2NvcGUuc2VhcmNoLmRlY01heEJpZF0gPSAoKSA9PiB7CgkgICAgICAgIHJldHVybiBvaygkKCIuZGVjcmVtZW50LXZhbHVlOmVxKDEpIikpOwoJICAgICAgfTsKCSAgICAgIC8qKgoJICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICovCgkgICAgICBvYmpbJHNjb3BlLnNlYXJjaC5pbmNNYXhCaWRdID0gKCkgPT4gewoJICAgICAgICByZXR1cm4gb2soJCgiLmluY3JlbWVudC12YWx1ZTplcSgxKSIpKTsKCSAgICAgIH07CgkgICAgICAvKioKCSAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAqLwoJICAgICAgb2JqWyRzY29wZS5zZWFyY2guZGVjTWluQnV5XSA9ICgpID0+IHsKCSAgICAgICAgcmV0dXJuIG9rKCQoIi5kZWNyZW1lbnQtdmFsdWU6ZXEoMikiKSk7CgkgICAgICB9OwoJICAgICAgLyoqCgkgICAgICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CgkgICAgICAgKi8KCSAgICAgIG9ialskc2NvcGUuc2VhcmNoLmluY01pbkJ1eV0gPSAoKSA9PiB7CgkgICAgICAgIHJldHVybiBvaygkKCIuaW5jcmVtZW50LXZhbHVlOmVxKDIpIikpOwoJICAgICAgfTsKCSAgICAgIC8qKgoJICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICovCgkgICAgICBvYmpbJHNjb3BlLnNlYXJjaC5kZWNNYXhCdXldID0gKCkgPT4gewoJICAgICAgICByZXR1cm4gb2soJCgiLmRlY3JlbWVudC12YWx1ZTplcSgzKSIpKTsKCSAgICAgIH07CgkgICAgICAvKioKCSAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAqLwoJICAgICAgb2JqWyRzY29wZS5zZWFyY2guaW5jTWF4QnV5XSA9ICgpID0+IHsKCSAgICAgICAgcmV0dXJuIG9rKCQoIi5pbmNyZW1lbnQtdmFsdWU6ZXEoMykiKSk7CgkgICAgICB9OwoJICAgICAgLyoqCgkgICAgICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CgkgICAgICAgKi8KCSAgICAgIG9ialskc2NvcGUuc2VhcmNoLnNlYXJjaF0gPSAoKSA9PiB7CgkgICAgICAgIHJldHVybiBvaygkKCIuYnV0dG9uLWNvbnRhaW5lciAuYnRuLXN0YW5kYXJkLmNhbGwtdG8tYWN0aW9uIikpOwoJICAgICAgfTsKCSAgICB9IGVsc2UgewoJICAgICAgbGV0IG4gPSAkKCIubGlzdEZVVEl0ZW0iKTsKCSAgICAgIGxldCBpID0gbi5sZW5ndGggPiAwOwoJICAgICAgbGV0IHMgPSBuLnBhcmVudHMoIi5wYWdpbmF0ZWQsIC51dC13YXRjaC1saXN0LXZpZXcsIC51dC10cmFuc2Zlci1saXN0LXZpZXciKTsKCSAgICAgIGlmICgwID09IHMubGVuZ3RoKSB7CgkgICAgICAgIHMgPSBuLnBhcmVudCgpOwoJICAgICAgfQoJICAgICAgaWYgKGkgJiYgJCgiLkRldGFpbFBhbmVsID4gLmJpZE9wdGlvbnMiKS5sZW5ndGggPiAwKSB7CgkgICAgICAgIC8qKgoJICAgICAgICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CgkgICAgICAgICAqLwoJICAgICAgICBvYmpbJHNjb3BlLnJlc3VsdHMuYmlkXSA9ICgpID0+IHsKCSAgICAgICAgICByZXR1cm4gb2soJCgiLmJpZEJ1dHRvbiIpKTsKCSAgICAgICAgfTsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAgICovCgkgICAgICAgIG9ialskc2NvcGUucmVzdWx0cy5idXldID0gKCkgPT4gewoJICAgICAgICAgIHJldHVybiB2b2lkKG9rKCQoIi5idXlCdXR0b24iKSkgJiYgJHNjb3BlLnJlc3VsdHMucHJlc3NFbnRlciAmJiB0cnlQYXJzZVFSQ29kZSgpKTsKCSAgICAgICAgfTsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAgICovCgkgICAgICAgIG9ialskc2NvcGUucmVzdWx0cy5kZWNCaWRdID0gKCkgPT4gewoJICAgICAgICAgIHJldHVybiBvaygkKCIuYmlkT3B0aW9ucyAuZGVjcmVtZW50LXZhbHVlIikpOwoJICAgICAgICB9OwoJICAgICAgICAvKioKCSAgICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICAgKi8KCSAgICAgICAgb2JqWyRzY29wZS5yZXN1bHRzLmluY0JpZF0gPSAoKSA9PiB7CgkgICAgICAgICAgcmV0dXJuIG9rKCQoIi5iaWRPcHRpb25zIC5pbmNyZW1lbnQtdmFsdWUiKSk7CgkgICAgICAgIH07CgkgICAgICB9CgkgICAgICBpZiAoaSAmJiAkKCIuRGV0YWlsUGFuZWwgPiAudXQtYnV0dG9uLWdyb3VwIikubGVuZ3RoID4gMCkgewoJICAgICAgICAvKioKCSAgICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICAgKi8KCSAgICAgICAgb2JqWyRzY29wZS5yZXN1bHRzLnRyYW5zZmVyXSA9ICgpID0+IHsKCSAgICAgICAgICByZXR1cm4gb2soKCgpID0+IHsKCSAgICAgICAgICAgIHJldHVybiAkKGAudXQtYnV0dG9uLWdyb3VwID4gYnV0dG9uOmNvbnRhaW5zKCcke0hhbi5sb2NhbGl6ZSgiaW5mb3BhbmVsLmxhYmVsLnNlbmRUcmFkZVBpbGUiKX0nKWApOwoJICAgICAgICAgIH0pKCkpOwoJICAgICAgICB9OwoJICAgICAgICAvKioKCSAgICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICAgKi8KCSAgICAgICAgb2JqWyRzY29wZS5yZXN1bHRzLmNsdWJdID0gKCkgPT4gewoJICAgICAgICAgIHJldHVybiBvaygoKCkgPT4gewoJICAgICAgICAgICAgcmV0dXJuICQoYC51dC1idXR0b24tZ3JvdXAgPiBidXR0b246Y29udGFpbnMoJyR7SGFuLmxvY2FsaXplKCJpbmZvcGFuZWwubGFiZWwuc3RvcmVJbkNsdWIiKX0nKWApOwoJICAgICAgICAgIH0pKCkpOwoJICAgICAgICB9OwoJICAgICAgICAvKioKCSAgICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICAgKi8KCSAgICAgICAgb2JqWyRzY29wZS5yZXN1bHRzLnNlbGxdID0gKCkgPT4gewoJICAgICAgICAgIHJldHVybiBvaygoKCkgPT4gewoJICAgICAgICAgICAgcmV0dXJuICQoYC51dC1idXR0b24tZ3JvdXAgPiBidXR0b246Y29udGFpbnMoJyR7SGFuLmxvY2FsaXplKCJpbmZvcGFuZWwubGFiZWwuZGlzY2FyZCIpfScpYCk7CgkgICAgICAgICAgfSkoKSk7CgkgICAgICAgIH07CgkgICAgICB9CgkgICAgICBpZiAoaSkgewoJICAgICAgICAvKioKCSAgICAgICAgICogQHJldHVybiB7dW5kZWZpbmVkfQoJICAgICAgICAgKi8KCSAgICAgICAgb2JqWyRzY29wZS5saXN0cy51cF0gPSAoKSA9PiB7CgkgICAgICAgICAgbGV0ICRwYXJlbnQgPSBzOwoJICAgICAgICAgIGxldCB0ID0gJCgiLmxpc3RGVVRJdGVtLnNlbGVjdGVkIiwgJHBhcmVudCkucHJldigpOwoJICAgICAgICAgIG9rKHQpOwoJICAgICAgICAgICRwYXJlbnQuY3NzKCJwb3NpdGlvbiIsICJyZWxhdGl2ZSIpOwoJICAgICAgICAgICRwYXJlbnQuc2Nyb2xsVG9wKCRwYXJlbnQuc2Nyb2xsVG9wKCkgKyB0LnBvc2l0aW9uKCkudG9wIC0gdC5oZWlnaHQoKSk7CgkgICAgICAgIH07CgkgICAgICAgIC8qKgoJICAgICAgICAgKiBAcmV0dXJuIHt1bmRlZmluZWR9CgkgICAgICAgICAqLwoJICAgICAgICBvYmpbJHNjb3BlLmxpc3RzLmRvd25dID0gKCkgPT4gewoJICAgICAgICAgIGxldCAkcGFyZW50ID0gczsKCSAgICAgICAgICBsZXQgaW50ZXJ2YWxGdW5jdGlvbkNhbGxlZCA9ICQoIi5saXN0RlVUSXRlbS5zZWxlY3RlZCIsICRwYXJlbnQpLm5leHQoKTsKCSAgICAgICAgICBvayhpbnRlcnZhbEZ1bmN0aW9uQ2FsbGVkKTsKCSAgICAgICAgICAkcGFyZW50LmNzcygicG9zaXRpb24iLCAicmVsYXRpdmUiKTsKCSAgICAgICAgICAkcGFyZW50LnNjcm9sbFRvcCgkcGFyZW50LnNjcm9sbFRvcCgpICsgaW50ZXJ2YWxGdW5jdGlvbkNhbGxlZC5wb3NpdGlvbigpLnRvcCk7CgkgICAgICAgIH07CgkgICAgICB9CgkgICAgICBpZiAoJCgiLnBhZ2luZ0NvbnRhaW5lciIpLmxlbmd0aCA+IDApIHsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAgICovCgkgICAgICAgIG9ialskc2NvcGUubGlzdHMucHJldl0gPSAoKSA9PiB7CgkgICAgICAgICAgcmV0dXJuIG9rKCQoIi5wYWdpbmdDb250YWluZXIgLnByZXY6dmlzaWJsZSIpKTsKCSAgICAgICAgfTsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIEByZXR1cm4ge3VuZGVmaW5lZH0KCSAgICAgICAgICovCgkgICAgICAgIG9ialskc2NvcGUubGlzdHMubmV4dF0gPSAoKSA9PiB7CgkgICAgICAgICAgcmV0dXJuIG9rKCQoIi5wYWdpbmdDb250YWluZXIgLm5leHQ6dmlzaWJsZSIpKTsKCSAgICAgICAgfTsKCSAgICAgIH0KCSAgICB9CgkgICAgcmV0dXJuIG9iajsKCSAgfTsKCSAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCJrZXlkb3duIiwgKG9iaikgPT4gewoJICAgIGlmIChvYmoua2V5Q29kZSA9PSAkc2NvcGUuZW5hYmxlRGlzYWJsZSAmJiAoZXZlbnQgPSAhZXZlbnQpLCAhZXZlbnQpIHsKCSAgICAgIHJldHVybjsKCSAgICB9CgkgICAgY29uc29sZS5sb2cob2JqLmtleUNvZGUpCgkgICAgbGV0IGdvdG9OZXdPZmZsaW5lUGFnZSA9IGluaXQoKVtvYmoua2V5Q29kZV07CgkgICAgaWYgKGdvdG9OZXdPZmZsaW5lUGFnZSkgewoJICAgICAgZ290b05ld09mZmxpbmVQYWdlKCk7CgkgICAgfQoJICB9KTsKCSAgY29uc29sZS5sb2coIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzZWFyY2hTbiIpKQoJICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic2VhcmNoU24iKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCl7CgkgIAljb25zb2xlLmxvZygiZW50cmUiKQoJICAJbGV0IGdvdG9OZXdPZmZsaW5lUGFnZSA9IGluaXQoKVszOV07CgkgICAgaWYgKGdvdG9OZXdPZmZsaW5lUGFnZSkgewoJICAgICAgZ290b05ld09mZmxpbmVQYWdlKCk7CgkgICAgfQoJICAJbGV0IGdvdG9OZXdPZmZsaW5lUGFnZTIgPSBpbml0KClbNTBdOwoJICAgIGlmIChnb3RvTmV3T2ZmbGluZVBhZ2UyKSB7CgkgICAgICBnb3RvTmV3T2ZmbGluZVBhZ2UyKCk7CgkgICAgfQoJICB9KQoJICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYmFja1NuIikuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbigpewoJICAJY29uc29sZS5sb2coImVudHJlIikKCSAgCQoJICAJbGV0IGdvdG9OZXdPZmZsaW5lUGFnZSA9IGluaXQoKVs0OV07CgkgICAgaWYgKGdvdG9OZXdPZmZsaW5lUGFnZSkgewoJICAgICAgZ290b05ld09mZmxpbmVQYWdlKCk7CgkgICAgfQoJICB9KQoJICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiYnV5Tm93U24iKS5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIGZ1bmN0aW9uKCl7CgkgIAljb25zb2xlLmxvZygiZW50cmUiKQoJICAJbGV0IGdvdG9OZXdPZmZsaW5lUGFnZSA9IGluaXQoKVs1MV07CgkgICAgaWYgKGdvdG9OZXdPZmZsaW5lUGFnZSkgewoJICAgICAgZ290b05ld09mZmxpbmVQYWdlKCk7CgkgICAgfQoJICB9KQoJfSh7CgkgICJiYWNrIiA6IDQ5LAoJICAiZW5hYmxlRGlzYWJsZSIgOiAxODgsCgkgICJ0ZWNoIiA6IDg0LAoJICAibGlzdHMiIDogewoJICAgICJ1cCIgOiAzOCwKCSAgICAiZG93biIgOiA0MCwKCSAgICAicHJldiIgOiAzNywKCSAgICAibmV4dCIgOiAzOQoJICB9LAoJICAic2VhcmNoIiA6IHsKCSAgICAiZGVjTWluQmlkIiA6IDM3LAoJICAgICJpbmNNaW5CaWQiIDogMzksCgkgICAgImRlY01heEJpZCIgOiAzNSwKCSAgICAiaW5jTWF4QmlkIiA6IDM2LAoJICAgICJkZWNNaW5CdXkiIDogNDYsCgkgICAgImluY01pbkJ1eSIgOiAzNCwKCSAgICAiZGVjTWF4QnV5IiA6IDQwLAoJICAgICJpbmNNYXhCdXkiIDogMzgsCgkgICAgInNlYXJjaCIgOiA1MAoJICB9LAoJICAicmVzdWx0cyIgOiB7CgkgICAgImJpZCIgOiA1MiwKCSAgICAiYnV5IiA6IDUxLAoJICAgICJ0cmFuc2ZlciIgOiA4MiwKCSAgICAiY2x1YiIgOiA2NywKCSAgICAicHJlc3NFbnRlciIgOiB0cnVlLAoJICAgICJhdXRvQnV5IiA6IGZhbHNlLAoJICAgICJwcmV2ZW50QmFjayIgOiB0cnVlLAoJICAgICJzZWxsIiA6IDgxLAoJICAgICJkZWNCaWQiIDogNDYsCgkgICAgImluY0JpZCIgOiAzNAoJICB9Cgl9KTsKCgoKCgoKCgpVVE1hcmtldFNlYXJjaFJlc3VsdHNWaWV3Q29udHJvbGxlci5wcm90b3R5cGUuX3JlcXVlc3RJdGVtcyA9IGZ1bmN0aW9uIF9yZXF1ZXN0SXRlbXMobCkgewogICAgdGhpcy5fcGFnaW5hdGlvblZpZXdNb2RlbC5zdG9wQXVjdGlvblVwZGF0ZXMoKTsKICAgIGlmKHRoaXMuX3NlYXJjaENyaXRlcmlhLl90eXBlID09ICJwbGF5ZXIiKXsKICAgICAgICB2YXIgY29udGV4dCA9IHRoaXM7CgogICAgICAgIHJlcXVlc3RJdGVtcygpCiAgICB9IGVsc2UgewogICAgICAgIHNlcnZpY2VzLkl0ZW0uc2VhcmNoVHJhbnNmZXJNYXJrZXQodGhpcy5fc2VhcmNoQ3JpdGVyaWEsIGwpLm9ic2VydmUodGhpcywgZnVuY3Rpb24gX29uUmVxdWVzdEl0ZW1zQ29tcGxldGUoZSwgdCkgewogICAgICAgICAgICBpZiAoZS51bm9ic2VydmUodGhpcyksCiAgICAgICAgICAgICF0LnN1Y2Nlc3MpCiAgICAgICAgICAgICAgICByZXR1cm4gTmV0d29ya0Vycm9yTWFuYWdlci5jaGVja0NyaXRpY2FsU3RhdHVzKHQuc3RhdHVzKSA/IHZvaWQgTmV0d29ya0Vycm9yTWFuYWdlci5oYW5kbGVTdGF0dXModC5zdGF0dXMpIDogKHNlcnZpY2VzLk5vdGlmaWNhdGlvbi5xdWV1ZShbc2VydmljZXMuTG9jYWxpemF0aW9uLmxvY2FsaXplKCJwb3B1cC5lcnJvci5zZWFyY2hlcnJvciIpLCBlbnVtcy5VSU5vdGlmaWNhdGlvblR5cGUuTkVHQVRJVkVdKSwKICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5nZXROYXZpZ2F0aW9uQ29udHJvbGxlcigpLnBvcFZpZXdDb250cm9sbGVyKCkpOwogICAgICAgICAgICBpZiAoMCA8IHRoaXMuX3NlYXJjaENyaXRlcmlhLm9mZnNldCAmJiAwID09PSB0LmRhdGEuaXRlbXMubGVuZ3RoKQogICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEl0ZW1zKGwgLSAxKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICB2YXIgaSA9IHRoaXMuX3BhZ2luYXRpb25WaWV3TW9kZWwuZ2V0TnVtSXRlbXNQZXJQYWdlKCkKICAgICAgICAgICAgICAgIHZhciBvID0gdC5kYXRhLml0ZW1zLnNsaWNlKCk7CiAgICAgICAgICAgICAgICBzZXRJdGVtcyh0aGlzLG8saSx0LmRhdGEuaXRlbXMpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5fcGFnaW5hdGlvblZpZXdNb2RlbC5zdGFydEF1Y3Rpb25VcGRhdGVzKCkKICAgICAgICB9KQogICAgfQoKICAgIGZ1bmN0aW9uIHVwZGF0ZShkYXRhLGNvbnRleHQpIHsKICAgICAgICBVVEl0ZW1FbnRpdHlGYWN0b3J5LnByb3RvdHlwZS5hdWN0aW9uRmFjdG9yeSA9IG5ldyBVVEF1Y3Rpb25FbnRpdHlGYWN0b3J5KCkKICAgICAgICB2YXIgaSA9IGNvbnRleHQuX3BhZ2luYXRpb25WaWV3TW9kZWwuZ2V0TnVtSXRlbXNQZXJQYWdlKCkKICAgICAgICB2YXIgbyA9IFVUSXRlbUVudGl0eUZhY3RvcnkucHJvdG90eXBlLmdlbmVyYXRlSXRlbXNGcm9tQXVjdGlvbkRhdGEoZGF0YS5hdWN0aW9uSW5mbykKICAgICAgICBpZiAoMCA8IGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLm9mZnNldCAmJiAwID09PSBkYXRhLmF1Y3Rpb25JbmZvLmxlbmd0aCkKICAgICAgICAgICAgICAgIGNvbnRleHQuX3JlcXVlc3RJdGVtcyhsIC0gMSk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgc2V0SXRlbXMoY29udGV4dCxvLGksZGF0YS5hdWN0aW9uSW5mbykKICAgICAgICB9CiAgICAgICAgY29udGV4dC5fcGFnaW5hdGlvblZpZXdNb2RlbC5zdGFydEF1Y3Rpb25VcGRhdGVzKCkgICAKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRGaWx0ZXJzKGNvbnRleHQsdXJsKXsKICAgICAgICBpZihjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5yYXJpdGllcy5sZW5ndGg+MCl7CiAgICAgICAgICAgIHVybCA9IHVybCArICImcmFyaXR5SWRzPSIrY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEucmFyaXRpZXNbMF0gICAgCiAgICAgICAgfQogICAgICAgIGlmKGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLm5hdGlvbiE9LTEpewogICAgICAgICAgICB1cmwgPSB1cmwgKyAiJm5hdD0iKyBjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5uYXRpb24KICAgICAgICB9CiAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubGV2ZWwhPSJhbnkiKXsKICAgICAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubGV2ZWwgPT0gIlNQIil7CiAgICAgICAgICAgICAgICB1cmwgPSB1cmwgKyAiJnJhcmU9IisgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubGV2ZWwKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHVybCA9IHVybCArICImbGV2PSIrIGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLmxldmVsCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEuY2x1YiE9LTEpewogICAgICAgICAgICB1cmwgPSB1cmwgKyAiJnRlYW09IisgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEuY2x1YgogICAgICAgIH0KICAgICAgICBpZihjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5fem9uZSE9LTEpewogICAgICAgICAgICB2YXIgem9uZXMgPSB7CiAgICAgICAgICAgICAgICAiMTMwIjogImRlZmVuc2UiLAogICAgICAgICAgICAgICAgIjEzMSI6ICJtaWRmaWVsZCIsCiAgICAgICAgICAgICAgICAiMTMyIjogImF0dGFja2VyIiAKICAgICAgICAgICAgfQogICAgICAgICAgICB1cmwgPSB1cmwgKyAiJnpvbmU9Iisgem9uZXNbY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEuX3pvbmVdCiAgICAgICAgfQogICAgICAgIGlmKGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLnBvc2l0aW9uIT0iYW55Iil7CiAgICAgICAgICAgIHVybCA9IHVybCArICImcG9zPSIrIGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLnBvc2l0aW9uCiAgICAgICAgfQogICAgICAgIGlmKGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLm1hc2tlZERlZklkKXsKICAgICAgICAgICAgdXJsID0gdXJsICsgIiZtYXNrZWREZWZJZD0iKyBjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5tYXNrZWREZWZJZAogICAgICAgIH0gICAgCiAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubGVhZ3VlIT0tMSl7CiAgICAgICAgICAgIHVybCA9IHVybCArICImbGVhZz0iKyBjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5sZWFndWUKICAgICAgICB9CiAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEucGxheVN0eWxlIT0tMSl7CiAgICAgICAgICAgIHVybCA9IHVybCArICImcGxheVN0eWxlPSIrIGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLnBsYXlTdHlsZQogICAgICAgIH0KICAgICAgICBpZihjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5taW5CdXkpewogICAgICAgICAgICB1cmwgPSB1cmwgKyAiJm1pbmI9IisgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubWluQnV5CiAgICAgICAgfQogICAgICAgIGlmKGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLm1heEJ1eSl7CiAgICAgICAgICAgIHVybCA9IHVybCArICImbWF4Yj0iKyBjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5tYXhCdXkKICAgICAgICB9CiAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubWluQmlkKXsKICAgICAgICAgICAgdXJsID0gdXJsICsgIiZtaWNyPSIrIGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLm1pbkJpZAogICAgICAgIH0KICAgICAgICBpZihjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5taW5CaWQpewogICAgICAgICAgICB1cmwgPSB1cmwgKyAiJm1pY3I9IisgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEubWluQmlkCiAgICAgICAgfQogICAgICAgIGlmKGNvbnRleHQuX3NlYXJjaENyaXRlcmlhLm1heEJpZCl7CiAgICAgICAgICAgIHVybCA9IHVybCArICImbWFjcj0iKyBjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5tYXhCaWQKICAgICAgICB9CiAgICAgICAgaWYoY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEuZGVmSWQubGVuZ3RoPjApewogICAgICAgICAgICB1cmwgPSB1cmwgKyAiJmRlZmluaXRpb25JZD0iKyBjb250ZXh0Ll9zZWFyY2hDcml0ZXJpYS5kZWZJZFswXQogICAgICAgIH0KICAgICAgICByZXR1cm4gdXJsCiAgICB9CgogICAgZnVuY3Rpb24gcmVxdWVzdEl0ZW1zKCl7CiAgICAgICAgdmFyIHVybCA9IGAke3NlcnZpY2VzLkF1dGhlbnRpY2F0aW9uLnNlc3Npb25VdGFzLnVybH0vdXQvZ2FtZS9maWZhMjEvdHJhbnNmZXJtYXJrZXQ/bnVtPTIxJnN0YXJ0PSR7KGwtMSkqMjB9JnR5cGU9cGxheWVyYDsKICAgICAgICB1cmwgPSBhZGRGaWx0ZXJzKGNvbnRleHQsdXJsKQogICAgICAgIGZldGNoKHVybCwgewogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICJYLVVULVNJRCI6IHNlcnZpY2VzLkF1dGhlbnRpY2F0aW9uLmdldFV0YXNTZXNzaW9uKClbImlkIl0KICAgICAgICB9fSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkgewogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgICB1cGRhdGUoZGF0YSxjb250ZXh0KSAgICAgICAgICAgICAKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcil7CiAgICAgICAgICAgIHNlcnZpY2VzLk5vdGlmaWNhdGlvbi5xdWV1ZShbc2VydmljZXMuTG9jYWxpemF0aW9uLmxvY2FsaXplKCJwb3B1cC5lcnJvci5zZWFyY2hlcnJvciIpLGVudW1zLlVJTm90aWZpY2F0aW9uVHlwZS5ORUdBVElWRV0pCiAgICAgICAgICAgIHZvaWQgY29udGV4dC5nZXROYXZpZ2F0aW9uQ29udHJvbGxlcigpLnBvcFZpZXdDb250cm9sbGVyKCk7CiAgICAgICAgfSkKICAgIH0KCiAgICBmdW5jdGlvbiBzZXRJdGVtcyhjb250ZXh0LG8saSxyZXNwb25zZUl0ZW1zKXsKICAgICAgICBpZiAoY29udGV4dC5vbkRhdGFDaGFuZ2Uubm90aWZ5KHsKICAgICAgICAgICAgaXRlbXM6IG8KICAgICAgICB9KSwKICAgICAgICBvLmxlbmd0aCA+IGkgJiYgKG8gPSBvLnNsaWNlKDAsIGkpKSwKICAgICAgICBjb250ZXh0Ll9wYWdpbmF0aW9uVmlld01vZGVsLnNldFBhZ2VJdGVtcyhvKSwKICAgICAgICBjb250ZXh0Ll9wYWdpbmF0aW9uVmlld01vZGVsLnNldFBhZ2VJbmRleChsKSwKICAgICAgICBjb250ZXh0Ll9zZWxlY3RlZEl0ZW0gJiYgMCA8IG8ubGVuZ3RoKSB7CiAgICAgICAgICAgIHZhciBuID0gY29udGV4dC5fcGFnaW5hdGlvblZpZXdNb2RlbC5nZXRJbmRleEJ5SXRlbUlkKGNvbnRleHQuX3NlbGVjdGVkSXRlbS5pZCk7CiAgICAgICAgICAgIDAgPCBuICYmIGNvbnRleHQuX3BhZ2luYXRpb25WaWV3TW9kZWwuc2V0SW5kZXgobiksCiAgICAgICAgICAgIGNvbnRleHQuX3NlbGVjdGVkSXRlbSA9IG51bGwKICAgICAgICB9CiAgICAgICAgdmFyIHMgPSBjb250ZXh0LmdldFZpZXcoKQogICAgICAgICAgLCByID0gbnVsbDsKICAgICAgICBpZiAoIWNvbnRleHQuX3N0YWRpdW1WaWV3bW9kZWwgfHwgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEudHlwZSAhPT0gU2VhcmNoVHlwZS5WQU5JVFkgJiYgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEudHlwZSAhPT0gU2VhcmNoVHlwZS5DTFVCX0lORk8gJiYgY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEudHlwZSAhPT0gU2VhcmNoVHlwZS5CQUxMIHx8IChyID0gY29udGV4dC5fc3RhZGl1bVZpZXdtb2RlbC5nZXRTdGFkaXVtUHJvZ3Jlc3Npb24oY29udGV4dC5fc2VhcmNoQ3JpdGVyaWEuc3VidHlwZXMpKSwKICAgICAgICBzLnNldEl0ZW1zKGNvbnRleHQuX3BhZ2luYXRpb25WaWV3TW9kZWwuZ2V0Q3VycmVudFBhZ2VJdGVtcygpLCByKSwKICAgICAgICBzLnNldFBhZ2luYXRpb25TdGF0ZSgxIDwgbCwgcmVzcG9uc2VJdGVtcy5sZW5ndGggPiBpKSwKICAgICAgICBKU1V0aWxzLmlzVmFsaWQoY29udGV4dC5fY29tcGFyZUl0ZW0pICYmICFjb250ZXh0Ll9zcXVhZENvbnRleHQpIHsKICAgICAgICAgICAgdmFyIGEgPSBKU1V0aWxzLmZpbmQobywgZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGUuZ2V0QXVjdGlvbkRhdGEoKS50cmFkZUlkID09PSBjb250ZXh0Ll9jb21wYXJlSXRlbS5nZXRBdWN0aW9uRGF0YSgpLnRyYWRlSWQKICAgICAgICAgICAgfQogICAgICAgICAgICAuYmluZChjb250ZXh0KSk7CiAgICAgICAgICAgIEpTVXRpbHMuaXNWYWxpZChhKSA/IGNvbnRleHQuX3Bpbm5lZExpc3RJdGVtLnNldEl0ZW0oYSkgOiBjb250ZXh0Ll9wYWdpbmF0aW9uVmlld01vZGVsLnNldFBpbm5lZEl0ZW0oY29udGV4dC5fY29tcGFyZUl0ZW0pCiAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICFpc1Bob25lKCkgJiYgMCA8IG8ubGVuZ3RoICYmIHMuc2VsZWN0TGlzdFJvdyhjb250ZXh0Ll9wYWdpbmF0aW9uVmlld01vZGVsLmdldEN1cnJlbnRJdGVtKCkuaWQpCiAgICB9Cn0KCgphY2Nlc3NvYmplY3RzLkNsdWIuZ2V0VXJsUGFyYW1zID0gZnVuY3Rpb24oc2VhcmNoQ3JpdGVyaWEpIHsKICAgIHZhciBjcml0ZXJpYSA9IHt9OwogICAgY3JpdGVyaWEudHlwZSA9IHNlYXJjaENyaXRlcmlhLnR5cGUgPT09IFNlYXJjaFR5cGUuQU5ZID8gU2VhcmNoVHlwZS5QTEFZRVIgOiBzZWFyY2hDcml0ZXJpYS50eXBlLAogICAgY3JpdGVyaWEuc3RhcnQgPSBzZWFyY2hDcml0ZXJpYS5vZmZzZXQsCiAgICBjcml0ZXJpYS5jb3VudCA9IHNlYXJjaENyaXRlcmlhLmNvdW50OwogICAgdmFyIGZvcm1lZENyaXRlcmlhID0gY3JpdGVyaWE7CiAgICBzZWFyY2hDcml0ZXJpYS5zb3J0QnkgPT09IFNlYXJjaFNvcnRUeXBlLlJFQ0VOQ1kgPyBmb3JtZWRDcml0ZXJpYS5hY3F1aXJlZERhdGUgPSBzZWFyY2hDcml0ZXJpYS5zb3J0IDogKGZvcm1lZENyaXRlcmlhLnNvcnQgPSBzZWFyY2hDcml0ZXJpYS5zb3J0LAogICAgZm9ybWVkQ3JpdGVyaWEuc29ydCAhPT0gU2VhcmNoU29ydE9yZGVyLk5PTkUgJiYgKGZvcm1lZENyaXRlcmlhLnNvcnRCeSA9IHNlYXJjaENyaXRlcmlhLnNvcnRCeSkpOwogICAgaWYgKHNlYXJjaENyaXRlcmlhLnR5cGUgPT09IFNlYXJjaFR5cGUuVkFOSVRZKQogICAgICAgIGZvcm1lZENyaXRlcmlhLnZhbml0eVN1YlR5cGVJZHMgPSBzZWFyY2hDcml0ZXJpYS5zdWJ0eXBlczsKICAgIGVsc2UKICAgICAgICBzZWFyY2hDcml0ZXJpYS5jYXRlZ29yeSAhPT0gU2VhcmNoQ2F0ZWdvcnkuQU5ZICYmIChmb3JtZWRDcml0ZXJpYS50eXBlID0gc2VhcmNoQ3JpdGVyaWEuY2F0ZWdvcnkudG9Mb3dlckNhc2UoKSk7CiAgICBpZiAoc2VhcmNoQ3JpdGVyaWEucmFyaXRpZXMubGVuZ3RoID4gMCkKICAgICAgICBmb3JtZWRDcml0ZXJpYS5yYXJpdHlJZHMgPSBzZWFyY2hDcml0ZXJpYS5yYXJpdGllcy5qb2luKCcsJyk7CiAgICBpZiAoc2VhcmNoQ3JpdGVyaWEubGV2ZWwgPT09IGVudW1zLlNlYXJjaExldmVsLlNQRUNJQUwpCiAgICAgICAgZm9ybWVkQ3JpdGVyaWEucmFyZSA9IHNlYXJjaENyaXRlcmlhLmxldmVsOwogICAgZWxzZQogICAgICAgIHNlYXJjaENyaXRlcmlhLmxldmVsICE9PSBlbnVtcy5TZWFyY2hMZXZlbC5BTlkgJiYgKGZvcm1lZENyaXRlcmlhLmxldmVsID0gc2VhcmNoQ3JpdGVyaWEubGV2ZWwpOwogICAgc2VhcmNoQ3JpdGVyaWEuY2x1YiA+IDAgJiYgKGZvcm1lZENyaXRlcmlhLnRlYW0gPSBzZWFyY2hDcml0ZXJpYS5jbHViKTsKICAgIHNlYXJjaENyaXRlcmlhLmxlYWd1ZSA+IDAgJiYgKGZvcm1lZENyaXRlcmlhLmxlYWd1ZSA9IHNlYXJjaENyaXRlcmlhLmxlYWd1ZSk7CiAgICBzZWFyY2hDcml0ZXJpYS5uYXRpb24gPiAwICYmIChmb3JtZWRDcml0ZXJpYS5uYXRpb24gPSBzZWFyY2hDcml0ZXJpYS5uYXRpb24pOwogICAgc2VhcmNoQ3JpdGVyaWEudW50cmFkZWFibGVzICE9PSBlbnVtcy5TZWFyY2hVbnRyYWRlYWJsZXMuREVGQVVMVCAmJiAoZm9ybWVkQ3JpdGVyaWEuaXNVbnRyYWRlYWJsZSA9IHNlYXJjaENyaXRlcmlhLnVudHJhZGVhYmxlcyk7CiAgICBzZWFyY2hDcml0ZXJpYS5leGNsdWRlRGVmSWRzLmxlbmd0aCA+IDAgJiYgKGZvcm1lZENyaXRlcmlhLmV4Y2xkZWYgPSBzZWFyY2hDcml0ZXJpYS5leGNsdWRlRGVmSWRzLmpvaW4oJywnKSk7CiAgICBzZWFyY2hDcml0ZXJpYS5pc0V4YWN0U2VhcmNoICYmIChmb3JtZWRDcml0ZXJpYS5maWx0ZXIgPSAiZXhhY3QiKTsKICAgIGlmIChzZWFyY2hDcml0ZXJpYS56b25lICE9PSAtMSkKICAgICAgICBzd2l0Y2ggKHNlYXJjaENyaXRlcmlhLnpvbmUpIHsKICAgICAgICBjYXNlIFpPTkVfREVGRU5ERVJfVkFMVUU6CiAgICAgICAgICAgIGZvcm1lZENyaXRlcmlhWyJ0eXBlIl0gPSAicGxheWVyZGVmZW5kZXIiOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFpPTkVfTUlERklFTERFUl9WQUxVRToKICAgICAgICAgICAgZm9ybWVkQ3JpdGVyaWFbInR5cGUiXSA9ICJwbGF5ZXJtaWRmaWVsZGVyIjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSBaT05FX0FUVEFDS0VSX1ZBTFVFOgogICAgICAgICAgICBmb3JtZWRDcml0ZXJpYVsidHlwZSJdID0gInBsYXllcmZvcndhcmQiOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIFpPTkVfTk9fR0tfVkFMVUU6CiAgICAgICAgICAgIGZvcm1lZENyaXRlcmlhWyJ0eXBlIl0gPSAicGxheWVybm9uR0siOwogICAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBEZWJ1Z1V0aWxzLkFzc2VydCghW10sICJVbnN1cHBvcnRlZCB6b25lIElEIGluIGNsdWIgc2VhcmNoLiIpOwogICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICBlbHNlCiAgICAgICAgc2VhcmNoQ3JpdGVyaWEucG9zaXRpb24gIT09IFNlYXJjaFR5cGVbIkFOWSJdICYmIChmb3JtZWRDcml0ZXJpYS5wb3NpdGlvbiA9IHNlYXJjaENyaXRlcmlhLnBvc2l0aW9uKTsKICAgIHJldHVybiBzZWFyY2hDcml0ZXJpYS5wbGF5U3R5bGUgPiAwICYmIChmb3JtZWRDcml0ZXJpYS5wbGF5U3R5bGUgPSBzZWFyY2hDcml0ZXJpYS5wbGF5U3R5bGUpLAogICAgc2VhcmNoQ3JpdGVyaWEuaGFzVmFsaWREZWZJZCgpICYmIChmb3JtZWRDcml0ZXJpYS5kZWZJZCA9IHNlYXJjaENyaXRlcmlhLmRlZklkLmpvaW4oJywnKSksCiAgICBmb3JtZWRDcml0ZXJpYTsKfQ=='))
